
\newcommand{\fds}[1]{\EM{\fd_{#1}}}
\newcommand{\fdsp}[1]{\EM{\fd'_{#1}}}
\newcommand{\mds}[1]{\EM{\md_{#1}}}%
\newcommand{\fdspp}[1]{\EM{\fd_{#1}''}}
\newcommand{\mdspp}[1]{\EM{\md_{#1}''}}%
\newcommand{\mdsp}[1]{\EM{\md_{#1}'}}%
\newcommand{\kty}[1]{\EM{\xt{kty}(#1)}}
\newcommand{\tr}[2]{\EM{\xt{t #1}(#2)}}
\newcommand{\rc}[2]{\EM{\xt{r #1}(#2)}}
\newcommand{\WHERE}{~\EM{\xt{\bf where}}~}
\newcommand{\OR}{\EM{~\xt{\bf or}}~}
\newcommand{\IF}{\EM{~\xt{\bf if}}~}
\renewcommand{\neq}{\EM{\not=}}
\newcommand{\HS}{\hspace{.2cm}}
\newcommand{\name}[3]{\EM{#1\!\!:\!#2\!\!:\!#3}}
\newcommand{\namet}[2]{\EM{#1\!\!\,:\,\!#2}}
\newcommand{\TypeCk}[3]{\EM{#1\vdash #2:#3}}
\newcommand{\IN}{\EM{\in}}





%% Formatting
\newcommand{\EM}[1]{\ensuremath{#1}\xspace}
\newcommand{\xt}[1]{{\sf{#1}}}
\newcommand{\bt}[1]{\xt{\bf #1}}
\renewcommand{\b}[1]{\EM{\overline{#1}}}
\newcommand{\EMxt}[1]{\EM{\xt{#1}}}
\newcommand{\EMbt}[1]{\EM{\bt{#1}}}

%% Variables
\newcommand{\x}   {\EMxt x}
\newcommand{\xp}   {\EMxt{x'}}
\newcommand{\n}   {\EMxt n}
\newcommand{\e}   {\EMxt e}
\newcommand{\m}   {\EMxt m}
\newcommand{\mdt}   {\EMxt{m_t}}
\newcommand{\mdu}   {\EMxt {m_u}}
\renewcommand{\mp}   {\EMxt{m'}}
\newcommand{\s}   {\EM{\sigma}}
\DeclareDocumentCommand\t{o}{\IfNoValueTF{#1}{\EMxt t}{\EM{\xt t_{#1}}}}
\DeclareDocumentCommand{\tp}{o}{\IfNoValueTF{#1}{\EM{ \t' }}{\EM{\t_{#1}'}}}
\newcommand{\tpp}  {\EM{ \t''}}
\newcommand{\tppp}  {\EM{ \t'''}}
\newcommand{\ta}  {\EM{\tau}}
\renewcommand{\a} {\EMxt a}
\newcommand{\K}   {\EMxt K}
\newcommand{\W}   {\EMxt W}
\newcommand{\Wp}  {{\EMxt{W'}}}
\newcommand{\Wpp}  {{\EMxt{W''}}}
\renewcommand{\k} {\EMxt k}
\newcommand{\Kk}   {\K~\k}
\newcommand{\Kp}  {{\EMxt{K'}}}
\newcommand{\Kpp}  {{\EMxt{K''}}}
\newcommand{\Kppp}  {{\EMxt{K'''}}}
\newcommand{\ep}  {{{\EMxt{e'}}}}
\newcommand{\eps}[1]  {{{\EMxt{e'_{#1}}}}}
\newcommand{\epp}  {{{\EMxt{e''}}}}
\renewcommand{\sp}{{{\EM{\s'}}}}
\newcommand{\spp}{{{\EM{\s''}}}}
\newcommand{\ap}  {\EM{\a'}}
\newcommand{\aE}[1]  {\EM{\a_{#1}}}
\newcommand{\app}  {\EM{\a''}}
\renewcommand{\C}   {\EMxt {C}}
\newcommand{\Cp}  {\EMxt{C'}}
\newcommand{\Cpp}  {\EMxt{C''}}
\newcommand{\Cppp}  {\EMxt{C'''}}
\newcommand{\E}   {\EMxt E}
\newcommand{\Ep}   {\EMxt{E'}}
\newcommand{\fd}  {\EMxt{fd}}
\newcommand{\md}  {\EMxt{md}}
\newcommand{\cmd}  {\EMxt{M}}
\newcommand{\cmdp}  {\EMxt{M'}}
\newcommand{\mdp}  {\EM{\md'}}
\newcommand{\mdpp}  {\EM{\md'}}
\newcommand{\mddp}  {\EM{\md''}}
\newcommand{\mdppp}  {\EM{\md''}}
\newcommand{\mt}  {\EMxt{mt}}
\newcommand{\mtp}  {\EMxt{mt'}}
\newcommand{\mtpp}  {\EMxt{mt''}}
\newcommand{\M}{\EM{\mu}}
\newcommand{\MN}  {\EMxt{M\,K}}
\newcommand{\MNargs}[1]  {\EMxt {M #1~K}}
\newcommand{\f}   {\EMxt f}
\newcommand{\fp}   {\EMxt{ f'}}
\newcommand{\Env}   {\EM{\Gamma}}
\newcommand{\Envp}   {\EM{\Gamma'}}
\newcommand{\EE}   {\EM{\mathcal{E}}}
\newcommand{\any} {\EM{\star}}
\newcommand{\this}{\EMxt{this}}
\newcommand{\that}{\EMxt{that}}
\newcommand{\none}{\EM{\cdot}}
\newcommand{\D}   {\EMxt D}
\newcommand{\Dp}   {\EMxt{D'}}
\newcommand{\Dpp}   {\EMxt{D''}}
\newcommand{\p}   {\EMxt p}
\newcommand{\np}{\n'}

\newcommand{\CW}    {\EMxt{?C}}
\newcommand{\CWp}   {\EMxt{?C'}}
\newcommand{\CWpp}  {\EMxt{?C''}}
\newcommand{\DW}     {\EMxt{?D}}
\newcommand{\DWp}    {\EMxt{?D'}}
\newcommand{\DWpp}   {\EMxt{?D''}}

% FZ: Get and Set are deprecated, use FRead and FWrite instead
\newcommand{\Get}[3]   {\EM{#1.#2_{#3}()}}
\newcommand{\sGet}[2]   {\EM{#1.#2()}}
\newcommand{\Set}[4]   {\EM{#1.#2_{#3 \rightarrow #3}(#4)}}
\newcommand{\sSet}[3]   {\EM{#1.#2(#3)}}

\newcommand{\FRead}[1]   {\EM{\this.#1}}
\newcommand{\FWrite}[2]  {\EM{\this.#1} = #2}
\newcommand{\FReadR}[2]   {\EM{#1.#2}}
\newcommand{\FWriteR}[3]  {\EM{#1.#2} = #3}
\newcommand{\Call}[3]  {\EM{#1.#2(#3)}}
\newcommand{\KCall}[5] {\EM{{#1}.{#2}_{{#4} \rightarrow {#5}}(#3)}}
\newcommand{\DynCall}[3]  {\EM{#1@#2_{\any\rightarrow\any}(#3)}}
\newcommand{\sDynCall}[3]  {\EM{#1@#2(#3)}}
\newcommand{\READ}[1]{\EM{\this.#1}}
\newcommand{\WRITE}[2]{\EM{\this.#1 = #2}}


\newcommand{\New}[2]   {\EM{\new\;#1(#2)}}
\newcommand{\SubCast}[2]{\EM{<\hspace{-.6mm}{#1}\hspace{-.6mm}>\hspace{-1mm}\;{#2}}}

\newcommand{\ShaStart}{\EM{\prec}}
\newcommand{\ShaEnd}{\EM{\succ}}
\newcommand{\ShaCast}[2]{\EM{\prec #1 \succ #2}}

\newcommand{\MonCast}[2]{\EM{\triangleleft\,  #1 \triangleright #2}}

\newcommand{\BehStart}{\EM{\blacktriangleleft}}
\newcommand{\BehEnd}{\EM{\blacktriangleright}}
\newcommand{\BehCast}[2]{\EM{\BehStart #1 \BehEnd #2}}


\newcommand{\new}      {\EM{\bt{new}}}
\newcommand{\HT}[2]    {\EM{{#1}\!:{#2}}}
\newcommand{\Mdef}[5]  {\EM{ \HT{ #1( \HT{#2}{#3})}{#4}\;\{{#5}\}}}
\newcommand{\NMdef}[7]  {\EM{ \HT{ #1(\HT{#2}{#3}, ~\HT{#4}{#5})}{#6}\;\{{#7}\}}}
\newcommand{\Mdefz}[3] {\EM{ \HT{ #1()}{#2}\;\{{#3}\}}}
\newcommand{\NMdefz}[5] {\EM{ \HT{#1(\HT{#2}{#3})}{#4}\;\{{#5}\}}}
\newcommand{\Mdefa}[4]  {\EM{ \HT{ #1( #2 )}{#3}~\{{#4}\}}}
\newcommand{\obj}[2]   { \EM{ #1\{#2\}}}
\newcommand{\alloc}[4] {\EM{#1\;#2  = \xt{alloc}(#3, #4)}}
\newcommand{\cast}[8]  {\EM{#6\;#7\;#8=\xt{#5 cast}(#1, #2, #3, #4)}}
\newcommand{\behcastz}[4] {\EM{\xt{behcast}(#1, #2, #3, #4)}}
\newcommand{\behcast}[7]  {\EM{\xt{behcast}(#1, #2, #3, #4)=#5\,#6\,#7}}
\newcommand{\moncast}[6]  {\EM{\xt{moncast}(#1, #2, #3, #4)=#5\,#6}}
\newcommand{\ThorSub}[4]{\EM{#1~#2 \vdash #3 \Sub_t #4}}
\newcommand{\soverloading}{\EM{\text{soverloading}}}

\newcommand{\Alt}[1]   { &\B #1 \\}
\newcommand{\B}        {\EM{~|~}}
\newcommand{\bang}     {\EM{\xt{!}}}
\newcommand{\ba}       {\xt{!}}

\newcommand{\dispatch}[5] {\EM{#1\;#2 = \xt{disp}(#3,#4,#5)}}
\newcommand{\readf}[4]{\EM{\xt{read}(#1,#2,#3,#4)}}
\newcommand{\convert}[1]{\EM{\xt{cnvtMD}(#1)}}
\newcommand{\convertFD}[1]{\EM{\xt{cnvtFD}(#1)}}
\newcommand{\readfield}[4]{\EM{#1 = \xt{read}(#2,#3,#4)}}
\newcommand{\setf}[5] {\EM{\xt{write}(#1,#2,#3,#4,#5)}}
\newcommand{\Reduce}[6]   {\EM{{#1}~{#2}~{#3} \rightarrow {#4}~{#5}~{#6}}}
\newcommand{\ReduceA}[6]  {\EM{#1~#2~#3 } & \EM{\rightarrow #4~#5~#6}}
\newcommand{\class}       {\EM{\bf{class}}}
\newcommand{\Class}[3]    {\EM{\bt{class}\;#1\,\{\,#2~#3\,\}}}
\newcommand{\Clasz}[3]    {\EM{\bt{class}\;#1\,\{\,#2 \;\; #3\,\}}}
\newcommand{\Ftype}[2]    {\EM{ \HT{#1}{#2} }}
\newcommand{\Fdef}[2]    {\EM{ \HT{#1}{#2} }}
\newcommand{\Mtype}[3]    {\EM{ \HT{#1(#2)}{#3}}}
\newcommand{\Type}[1]     {\EM{\{#1\}}}

\newcommand{\opdef}[2]    {\framebox[1.1\width]{#1} ~ #2\\}
\newcommand{\Map}[2]     {\EM{ #1[#2] }}
\newcommand{\Bind}[2]     {\EM{#1 \mapsto #2}}

\newcommand{\Sub}{\EM{<:}}
\newcommand{\Exten}{\EM{:<:}}
\newcommand{\OK}{\EM{~\checkmark}}
\newcommand{\names}[1]{\EM{\xt{names}(#1)}}
\newcommand{\cload}[1]{\EM{\xt{dupMeth}(#1)}}
\newcommand{\untyped}[1]{\EM{\xt{untyped}(#1)}}

\newcommand{\mnames}[1]{\EM{\xt{methName}(#1)}}
\newcommand{\fnames}[1]{\EM{\xt{fieldName}(#1)}}


\newcommand{\ConsSub}{\EM{\lesssim}}

\newcommand{\EvalRulePassthrough}[1]{#1}
\newcommand{\EvalRuleLabel}[1]{\EvalRulePassthrough{\tiny\scshape\textcolor{gray}{#1}}}
\newcommand{\CondRule}[3]{ \EvalRuleLabel{#1} & #3 & #2 \\}
\newcommand{\SuchRule}[3]{ #3 &~{\emph{s.t.}} #2 \\}
\newcommand{\EnvType}[5]{ \EM{#1\,#2\,#3\vdash #4 : #5}}
\newcommand{\EnvTypeNA}[3]{ \EM{#1\vdash #2 : #3}}

\newcommand{\RuleRef}[1]{\hyperlink{infer:#1}{\TirNameStyle{#1}}}
\newcommand{\IRule}[4][]{\inferrule*[lab={\tiny \hypertarget{infer:#2}{#2}},#1]{#3}{#4}}
\newcommand{\HasType}[3]{ \EM{#1} (\EM{#2}) = \EM{#3}}
\newcommand{\wrap}[5]{\EM{\xt{wrap}(#1,#2,#3,#4,#5)}}
\newcommand{\wrapAny}[4]{\EM{\xt{wrap}(#1,#2,#3,#4)}}
\newcommand{\spec}[4]{\EM{\xt{spec}(#1,#2,#3,#4)}}

\newcommand{\gmeth}[2]{\EM{\xt{genMeth}(#1,#2)}}
\newcommand{\gmethUT}[2]{\EM{\xt{genMeth}(#1)}}

\newcommand{\castfn}[4]{\text{cast}(#1,#2,#3,#4)}
% \newcommand{\GenCast}[5]{\src{#1~#2 \vdash #3 \hookrightarrow} ~#4~ \src{\Uparrow #5} }
\newcommand{\GenCast}[5]{#1~#2 \vdash #3 \Uparrow #5 \hookrightarrow \src{~#4~}} 
\newcommand{\AnaCast}[5]{#1~#2 \vdash #3 \Downarrow #5 \hookrightarrow ~\src{#4}}
\newcommand{\AnaCastG}[5]{\greyBox{#1~#2 \vdash #3 \Downarrow #5 \hookrightarrow} ~#4}
\newcommand{\GenCastMono}[6]{\src{#1~#2} \vdash \src{#3} \Uparrow \src{#5} \hookrightarrow #4~#6 }
\newcommand{\AnaCastMono}[6]{\src{#1~#2} \vdash \src{#3} \Downarrow \src{#5} \hookrightarrow #4~#6}
\newcommand{\TransClass}[2]{\EM{ #1 \rightharpoonup #2 }}
\newcommand{\inv}[2]{\xt{invoke}(#1, #2)}
\newcommand{\classoff}[2]{\EM{\xt{mtypes}(#1,#2)}}
\newcommand{\classoffs}[3]{\EM{\xt{mtypes}(#1,#2,#3)}}
\newcommand{\mtype}[3]{\EM{\xt{mtype}(#1,#2,#3)}}
\newcommand{\wftype}[3]{\EM{\xt{wftype}(#1,#2,#3)}}
\newcommand{\GenType}[5]{#1~#2 \vdash #3 \Uparrow #5}
\newcommand{\AnaType}[5]{#1~#2 \vdash #3 \Downarrow #5}

\newcommand{\field}[2]{\EM{\xt{field}(#1,#2)}}
\newcommand{\In}{\EM{\in}}

\newcommand{\T}{\EM{\xt T}}
\newcommand{\Cast}{Cast }
\newcommand{\fb}{\EM{\xt{f!}}}

\newcommand{\AND}{\EM{\wedge}}
\newcommand{\App}[2]{\EM{#1(#2)}}

\newcommand{\StrSub}[4]{\EM{#1~#2\vdash #3\Sub #4}}
\newcommand{\ThrSub}[4]{\EM{#1~#2\vdash_{th} #3~\src\Sub~#4}}
\newcommand{\ConSub}[4]{\EM{#1~#2 \vdash #3 \lesssim #4}}
\newcommand{\OKW}{\EM{~\checkmark_{th}}}
\newcommand{\EnvTypeW}[5]{ \EM{#1\,#2\,#3\vdash_{th} #4 : #5}}

\newcommand{\tmeet}[4]{\xt{tmeet}(#1,#2,#3,#4)}
\newcommand{\mmeet}[4]{\xt{mmeet}(#1,#2,#3,#4)}
\newcommand{\mtypes}[2]{\xt{mtypes}(#1,#2)}
\newcommand{\typez}[1]{\xt{typing}(#1)}
\newcommand{\sign}[1]{\xt{signature}(#1)}

\newcommand{\WFtype}[2]{\EM{#1\vdash#2 \OK}}
\newcommand{\WF}[4]{\EM{#1\,#2\,#3\vdash#4 \OK}}
\newcommand{\WFp}[2]{#1~#2\OK}
\newcommand{\WFq}[1]{#1\OK}

\newcommand{\WFtypeW}[2]{\EM{#1\vdash_{th}~ #2 \OK}}
\newcommand{\WFW}[4]{\EM{#1\,#2\,#3\vdash_{th}~#4 \OK}}
\newcommand{\WFpW}[2]{#1~#2\OKW}

\newcommand{\V}{\EMxt V}
\renewcommand{\P}{\EMxt P}
\newcommand{\Pp}{\EMxt{P'}}

\newcommand{\enfortype}[3]{\xt{enforType}(#1,#2,#3)} % enforType(C,K)  
\newcommand{\enformt}[3]{\xt{enforMeth}(#1,#2,#3)} % enforMeth(md)
\newcommand{\gettype}[2]{\xt{getType}(#1,#2)} % getType(C,K)  
\newcommand{\getmt}[1]{\xt{getMt}(#1)} % getMt(md)

\newcommand{\getmds}[2]{\xt{getmds}(#1,#2)} % getmds(C,K)
\newcommand{\unwrap}[2]{\xt{unWrap}(#1,#2)} % getMt(md)
\newcommand{\dyn}[1]{\xt{dyn}(#1)}

\newcommand{\retype}[5]{\xt{retype}(#1,#2,#3,#4,#5)}
\newcommand{\htype}[4]{\EM{\xt{htype}(#1,#2,#3,#4)}}
\newcommand{\ftypes}[4]{\xt{ftypes}(#1,#2,#3,#4)}
\newcommand{\typeof}[1]{\xt{typeOf}(#1)}
\newcommand{\classgen}[1]{\xt{monWrap}(#1)}
\newcommand{\typegen}[2]{\xt{typegen}(#1,#2)}
\renewcommand{\S}{\EM{\tau}}
\newcommand{\Sp}{\EM{\tau'}}
\newcommand{\Spp}{\EM{\tau''}}
\newcommand{\EQ}{\EM{\equiv}}

\newcommand{\Dom}[1]{\EM{\xt{dom}(#1)}}
\newcommand{\fresh}[1]{\EM{#1~\xt{fresh}}}

\newcommand{\progtrans}[2]{#1 ~\hookrightarrow_p \src{~#2}}
\newcommand{\classtrans}[3]{#1 \vdash #2 ~\hookrightarrow_c \src{~#3}}
\newcommand{\methtrans}[5]{#1~#2 \vdash #3 ~\hookrightarrow_m \src{~#4~#5}}
\newcommand{\fieldtrans}[3]{#1 ~\hookrightarrow_f \src{~#2~#3}}
\newcommand{\statictype}[3]{\xt{static}(#1,#2,#3)}
\newcommand{\monowrap}[2]{\xt{mwrap}(#1,#2)}

\newcommand{\methtranst}[5]{#1~#2 \vdash #3 ~\hookrightarrow_{mt} \src{~#4~#5}}
\newcommand{\methtransu}[5]{#1~#2 \vdash #3 ~\hookrightarrow_{mu} \src{~#4~#5}}
\newcommand{\fieldtranst}[3]{#1 ~\hookrightarrow_{ft} \src{~#2~#3}}
\newcommand{\fieldtransu}[3]{#1 ~\hookrightarrow_{fu} \src{~#2~#3}}

\newcommand{\Kt}[1]{\EM{\text{ktype}(#1)}}
\newcommand{\All}[1]{\EM{\forall ~\xt #1 ~.~}}
\newcommand{\SP}{\hspace{.5cm}}
\newcommand{\SPP}{\SP\SP}
\newcommand{\bmt}{\b{\mt}}
\newcommand{\bmd}{\b{\md}}
\newcommand{\bmtp}{\b{\mtp}}
\renewcommand\dots{\makebox[1em][c]{.\hfil.\hfil.}}

\newcommand{\IGNOREUNLESSNEEDED}[1]{}
\newcommand{\figref}[1]{Fig.~\ref{#1}\xspace}
\newcommand{\ruleref}[1]{Rule~{\small #1}\xspace}

\newcommand{\kafka}{{\sf KafKa}\xspace}
% \newcommand{\src}[1]{\underline{#1}}
\newcommand{\src}[1]{\colorbox[gray]{0.89}{$#1$}}
\newcommand{\dt}[1]{\xt{?}#1}

\newcommand{\consistent}[3]{\EM{#1 \vdash #2 ~\sim~ #3}}
\newcommand{\rtranst}[6]{#1 \Rightarrow #2 ~ #3 / #4 \vdash #5 \looparrowright_{beh} #6}
\newcommand{\rtranstz}[4]{#1 \Rightarrow #2 \vdash #3 \looparrowright_{mon} #4}


\newcolumntype{E}{>{\ttfamily}l<{}@{}}
\newcolumntype{V}{>{\hspace{1mm}\begin{minipage}{4.3cm}}l<{\end{minipage}\hspace{1mm}}@{}}
\newcolumntype{R}[1]{>{\hspace{1mm}\begin{minipage}{#1}}l<{\end{minipage}\hspace{1mm}}@{}}

\makeatletter
\newcommand{\efqn}{
\foreach\n in {1,...,\@listdepth}{foo}
}
\makeatother
\newlist{myEnumerate}{enumerate}{10}

\newenvironment{proofy}{
  \begin{myEnumerate}[resume=proofsteps,label={\textbf{\arabic*}. },ref=\arabic*]
}{
  \end{myEnumerate}
}
\DeclareDocumentCommand\stepp{o}{\IfNoValueTF{#1}{\item}{\item\hypertarget{proofstep:#1}{}\label{proofstep:#1}}}

\newcommand{\basis}{\hfill}
\newcommand{\caseof}[1]{\item\text{Case: } #1}
\newcommand{\rcaseof}[1]{\item\text{Case: } \RuleRef{#1}}

\newcommand{\refby}[1]{%
  \def\nextitem{\def\nextitem{,}}% Separator
  \renewcommand*{\do}[1]{\nextitem\hyperlink{proofstep:##1}{\ref{proofstep:##1}}}% How to process each item
  (\docsvlist{#1})% Process list
}


\newenvironment{casel}{
  \begin{myEnumerate}[label={\Alph*. }]
}{
  \end{myEnumerate}
}


\newenvironment{iknown}{
  \begin{enumerate*}[series=proofsteps,label={\textbf{\arabic*}. },ref=\arabic*]
}{
  \end{enumerate*}
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5

\newcommand{\greyBox}[1]{\colorbox[gray]{0.89}{$#1$}}

% Math definitions.
\newcommand{\ebox}[1]{\fbox{#1}\hfill\vspace{-1em}\centering}
\newcommand{\ex}[2]{\exists#1.~#2}
\newcommand{\fa}[2]{\forall#1.~#2}
\newcommand{\crd}[1]{\left|\ol{#1}\right|}

% Environment definitions.
\newcommand{\nothing}{\cdot}
\newcommand{\ctx}[2]{#1\vdash#2}
\newcommand{\ctxol}[2]{\ol{#1\vdash#2}}
% \NewDocumentCommand{\ok}{om}{\IfNoValueTF{#1}{}{#1\vdash}{#2~\checkmark}}
% \NewDocumentCommand{\okol}{om}{\ok[#1]{\ol{#2}}}
\newcommand{\tjdg}[3]{\ctx{#1}{#2:#3}}
\newcommand{\gtjdg}[2]{\tjdg{\Gamma}{#1}{#2}}
\newcommand{\ctjdg}[3]{\tjdg{\Gamma,#1}{#2}{#3}}
\newcommand{\etjdg}[2]{\tjdg{\nothing}{#1}{#2}}
\newcommand{\tjdgol}[3]{\ctx{#1}{\ol{#2:#3}}}
\newcommand{\gtjdgol}[2]{\tjdgol{\Gamma}{#1}{#2}}
\newcommand{\ctjdgol}[3]{\tjdgol{\Gamma,#1}{#2}{#3}}
\newcommand{\etjdgol}[2]{\tjdgol{\nothing}{#1}{#2}}

% % \newcommand{\new}[1]{\colorbox{gray!20}{#1}}

% \let\OldAxiomC=\AxiomC
% \RenewDocumentCommand{\AxiomC}{om}
%   {\IfNoValueTF{#1}{\OldAxiomC{#2}}{\OldAxiomC{\phantom{#1}}\UnaryInfC{#2}}}
\newcounter{rules}
\newenvironment{rules}[2]{\vspace{0.5em}\ebox{#2}
  \vspace{-1.5em}\setlength{\parskip}{2em}
  \renewenvironment{rule}[1]{%
    \protected@edef\@currentlabel{\textsc{#1-##1}}
    \RightLabel{(\textsc{#1-##1})}
  }{}
}{\vspace{1em}}

% Multiplicities with overline.
\newcommand{\ol}[1]{\overline{#1}}

% Shorter superscript prime.
% \def\p{^\prime}

% Proof summaries.
\newcounter{theo}
\renewcommand{\thetheo}{\textbf{\arabic{theo}}}
\newcommand{\theo}[1]
  {\vspace{0.5em}\noindent\refstepcounter{theo}\textbf{Theorem}~\thetheo~(#1).}
\newcounter{lem}
\renewcommand{\thelem}{\textbf{\arabic{lem}}}
\newcommand{\lem}[1]
  {\vspace{0.5em}\noindent\refstepcounter{lem}\textbf{Lemma}~\thelem~(#1).}


% Theorem definitions.

% \renewcounter{theorem}
\renewenvironment{theorem}[2]
  {\let\oldparindent=\parindent\setlength{\parindent}{0em}
    \refstepcounter{theorem}\textbf{Theorem~\thetheorem}~: #1\label{th:#2}
    \stepcounter{conds}\boolfalse{condonce}
    \newcommand{\lbl}[1]{\label{th:#2:##1}}
    \newcommand{\trf}[1]{\ref{th:#2:##1}}\vspace{1em}\par}
  {\setlength{\parindent}{\oldparindent}\vspace{1em}}

\newcounter{lemma}
\renewenvironment{lemma}[2]
  {\let\oldparindent=\parindent\setlength{\parindent}{0em}
    \refstepcounter{lemma} \underline{\underline{\textbf{Lemma~\thelemma}}}~: #1\label{lem:#2} 
    \stepcounter{conds}\boolfalse{condonce}
    \newcommand{\lbl}[1]{\label{lem:#2:##1}}
    \newcommand{\trf}[1]{\ref{lem:#2:##1}}\vspace{1em}\par}
  {\setlength{\parindent}{\oldparindent}\vspace{1em}}
  
\newcounter{conj}
\newenvironment{conj}[2]
  {\let\oldparindent=\parindent\setlength{\parindent}{0em}
    \refstepcounter{conj} \underline{\underline{\textbf{Conjecture~\thelemma}}}~: #1\label{lem:#2} 
    \stepcounter{conds}\boolfalse{condonce}
    \newcommand{\lbl}[1]{\label{lem:#2:##1}}
    \newcommand{\trf}[1]{\ref{lem:#2:##1}}\vspace{1em}\par}
  {\setlength{\parindent}{\oldparindent}\vspace{1em}}

\renewenvironment{proof}
  {\vspace{1em}\noindent\textbf{Proof}\stepcounter{steps}}{}

\newcounter{conds}
\newbool{condonce}
\newcounter{cond}[conds]
\renewcommand{\thecond}{\textbf{\alph{cond}}}
\newenvironment{conds}
  {\textit{\ifbool{condonce}{and if:}{If:\booltrue{condonce}}}
    \renewcommand{\cond}[1]{\par\hspace{2em}\numbox{cond}{\thecond}##1}}{}

\newcommand{\cond}[1]{\begin{conds}\cond{#1}\end{conds}}
\newcommand{\then}{\par\textit{then:}}
\newcommand{\where}{\par\textit{where:}}
\newcommand{\tor}{\par\textit{or:}}
\newcommand{\axiom}[1]{\par\hspace{2em}#1}

\newcommand{\listindent}{\addtolength\leftskip{2em}}

\newcounter{steps}
\NewDocumentEnvironment{case}{mo}
  {\vspace{.5em}\textbf{Case}:\hspace{1em}#1 \IfNoValueTF{#2}{}{:\hspace{1em}#2}
    \booltrue{stepspace}\stepcounter{steps}\par\listindent}{\par}
\newenvironment{analysis}[1]
  {\vspace{.5em} \textbf{Case analysis} on #1\par
    \renewcommand{\thestep}{\textbf{\roman{step}}}}{}

\newcommand{\stepwidth}{.55\textwidth-\leftskip}
\newcommand{\numwidth}{3.5em}

\newcounter{step}[steps]
\renewcommand{\thestep}{\textbf{\arabic{step}}}

\newcommand{\numbox}[2]{\refstepcounter{#1}\makebox[\numwidth][l]{#2.}}
\newcommand{\stepnum}{\numbox{step}{\thestep}}

\newcommand{\statem}[1]{\stepspace\stepnum #1}
\newcommand{\sletsingle}[1]{\stepspace\stepnum\textbf{let}~#1}
\newcommand{\slet}[2]{\stepspace\stepnum\textbf{let}~#1~=~#2}
\newcommand{\slets}[3]{\stepspace\stepnum\makebox[\stepwidth][l]{\textbf{let}~#1~=~#2} by #3} 
\newcommand{\sletwhere}[3]{\stepspace\stepnum\textbf{let}~#1~=~#2 \textbf{where} #3}
\newbool{stepspace}
\newcommand{\stepspace}
  {\ifbool{stepspace}{\vspace{0.4em}\boolfalse{stepspace}}{}\par}
\newcommand{\step}[2]
  {\stepspace\par\stepnum\makebox[\stepwidth][l]{#1} by #2}
\newcommand{\longstep}[2]
  {\stepspace\par\stepnum\makebox[\stepwidth][l]{#1} \par\makebox[9.4cm+\numwidth + \stepwidth] {by #2}}
\newcommand{\longstepA}[2]
  {\stepspace\par\stepnum\makebox[\stepwidth][l]{#1} \par\makebox[11.65cm+\numwidth + \stepwidth] {by #2}}
\newcommand{\longstepAA}[2]
  {\stepspace\par\stepnum\makebox[\stepwidth][l]{#1} \par\makebox[10.2cm+\numwidth + \stepwidth] {by #2}}
\newcommand{\longstepAAA}[2]
  {\stepspace\par\stepnum\makebox[\stepwidth][l]{#1} \par\makebox[14.80cm+\numwidth + \stepwidth] {by #2}}
\newcommand{\longstepB}[2]
  {\stepspace\par\stepnum\makebox[\stepwidth][l]{#1} \par\makebox[12.25cm+\numwidth + \stepwidth] {by #2}}
\newcommand{\longstepC}[2]
  {\stepspace\par\stepnum\makebox[\stepwidth][l]{#1} \par\makebox[11.75cm+\numwidth + \stepwidth] {by #2}}
\newcommand{\longstepD}[2]
  {\stepspace\par\stepnum\makebox[\stepwidth][l]{#1} \par\makebox[8.5cm+\numwidth + \stepwidth] {by #2}}
\newcommand{\longstepE}[2]
  {\stepspace\par\stepnum\makebox[\stepwidth][l]{#1} \par\makebox[8.75cm+\numwidth + \stepwidth] {by #2}}  
\newcommand{\longstepF}[2]
  {\stepspace\par\stepnum\makebox[\stepwidth][l]{#1} \par\makebox[11.2cm+\numwidth + \stepwidth] {by #2}}  
\newcommand{\longstepG}[2]
  {\stepspace\par\stepnum\makebox[\stepwidth][l]{#1} \par\makebox[11.2cm+\numwidth + \stepwidth] {by #2}}  
\newcommand{\longstepH}[2]
  {\stepspace\par\stepnum\makebox[\stepwidth][l]{#1} \par\makebox[13.5cm+\numwidth + \stepwidth] {by #2}}  
\newcommand{\longstepI}[2]
  {\stepspace\par\stepnum\makebox[\stepwidth][l]{#1} \par\makebox[11.3cm+\numwidth + \stepwidth] {by #2}}  
\newcommand{\longstepII}[2]
  {\stepspace\par\stepnum\makebox[\stepwidth][l]{#1} \par\makebox[12.0cm+\numwidth + \stepwidth] {by #2}}    
\newcommand{\longstepIII}[2]
  {\stepspace\par\stepnum\makebox[\stepwidth][l]{#1} \par\makebox[13.2cm+\numwidth + \stepwidth] {by #2}}
\newcommand{\longstepMJ}[2]
  {\stepspace\par\stepnum\makebox[\stepwidth][l]{#1} \par\makebox[11.0cm+\numwidth + \stepwidth] {by #2}}
\newcommand{\longstepMK}[2]
  {\stepspace\par\stepnum\makebox[\stepwidth][l]{#1} \par\makebox[11.7cm+\numwidth + \stepwidth] {by #2}} 
\newcommand{\longstepML}[2]
  {\stepspace\par\stepnum\makebox[\stepwidth][l]{#1} \par\makebox[11.2cm+\numwidth + \stepwidth] {by #2}}   
\newcommand{\longstepMM}[2]
  {\stepspace\par\stepnum\makebox[\stepwidth][l]{#1} \par\makebox[11.2cm+\numwidth + \stepwidth] {by #2}}    
\newcommand{\longstepMN}[2]
  {\stepspace\par\stepnum\makebox[\stepwidth][l]{#1} \par\makebox[11.0cm+\numwidth + \stepwidth] {by #2}}   
\newcommand{\longstepMO}[2]
  {\stepspace\par\stepnum\makebox[\stepwidth][l]{#1} \par\makebox[11.2cm+\numwidth + \stepwidth] {by #2}}     
  
\newsavebox{\stepsby}
\newenvironment{steps}[1]
  {\savebox{\stepsby}{#1}
    \renewcommand{\step}[1] {\stepnum##1\par}\stepspace
    \begin{math}\left.\hspace{-.1em}\begin{minipage}{\numwidth+\stepwidth}}
  { \end{minipage}\right\}\end{math} by \usebox{\stepsby}\par}
  
\newenvironment{longsteps}[1]
  {\newcommand{\stepsbysavedvalue}{#1}
    \renewcommand{\step}[1] {\stepnum##1\par}\stepspace
    \begin{math}\left.\hspace{-.1em}\begin{minipage}{\numwidth+\stepwidth}}
  { \end{minipage}\right\}\end{math} \begin{minipage}{\textwidth-\stepwidth+1em}by \stepsbysavedvalue{}\end{minipage}\par}

% \newenvironment{for}[2]
%  {\vspace{.5em}For all~#1$~\in~$#2\par\listindent\stepcounter{steps}
%    \renewcommand{\thestep}{\textbf{\roman{step}}}\booltrue{stepspace}}
%  {\par\booltrue{stepspace}\stepcounter{steps}}

\newcommand{\qs}{\quad\quad}
\newcommand{\na}{case N/A}
\newcommand{\trivial}{\vspace{.4em}Trivial.}
\newcommand{\trivialind}
  {\vspace{.4em}Result follows directly from the induction hypothesis.}
\newcommand{\done}[1]{\step{done}{#1}}
\newcommand{\byeq}[1]{\ref{eq:#1}}
\newcommand{\byind}{ind hyp}
\newcommand{\bycontra}{contradiction}
\newcommand{\bysubst}{substitution}
\newcommand{\byrewrite}{Barendregt}
\newcommand{\byprem}[1]{prem~\ref{eq:#1}}
\newcommand{\byprems}[1]{prems~\ref{eq:#1}}
\newcommand{\bylem}[1]{lemma~\ref{lem:#1}}
\newcommand{\bylems}[2]{lemmas~\ref{lem:#1},~\ref{lem:#2}}
\newcommand{\byth}[1]{theorem~\ref{th:#1}}
\newcommand{\bythh}[2]{theorems~\ref{th:#1},~\ref{th:#2}}
\newcommand{\byfun}[1]{\fname{#1}}

\newcommand{\bypre}[2]{the premise of \texttt{\sc #1} on #2}
\newcommand{\bydef}[2]{the definition of \texttt{\sc #1} on #2}
\newcommand{\bydefE}[3]{the definition of \texttt{\sc #1} on #2 with #3}
\newcommand{\byjdg}[2]{\texttt{\sc #1} on #2}
\newcommand{\bysub}[1]{substitution convention on #1}
\newcommand{\bypres}[2]{the premises of \texttt{\sc #1} on #2}
\newcommand{\bylemm}[3]{\texttt{\sc lemma #1} on #3}
\newcommand{\bylemms}[3]{\texttt{\sc lemma #1:} #2 on #3}
\newcommand{\byweaklemm}[3]{\texttt{\sc Weakening lemma #1} on #3}
\newcommand{\byweaklemms}[3]{\texttt{\sc Weakening lemma #1:} #2 on #3}
\newcommand{\byindhyp}[1]{the inductive hyp on #1}
\newcommand{\bycons}[1]{the contradiction assumption on #1}
\newcommand{\bycontrad}[1]{contradicting statements #1}
\newcommand{\bysyn}[1]{syntax convention on #1}
\newcommand{\bysubs}[1]{substitution convention of #1}

\newcommand{\indmsg}[1]{induction on the derivation of #1}
\newcommand{\ind}[1]{by straightforward \indmsg{#1}.}
\newcommand{\indana}[1]{by \indmsg{#1}, with a case analysis on the last step: \\}
\newcommand{\indanaa}[1]{by \indmsg{#1}, with a case analysis on the last step. \\}
\newcommand{\strind}[1]{by structural induction on #1:}
\newcommand{\innat}{by natural deduction.\\}
\newcommand{\innatE}[1]{by natural deduction #1.\\}
\newcommand{\contrad}{by contradiction.\\}

% \newcommand{\E}{\ensuremath{\mathcal{E}}}
% \newcommand{\many}[1]{\ensuremath{\overline{\code{#1}}}}
% \newcommand{\code}[1]{\ensuremath{\textnormal {\texttt {#1}}}}
% \newcommand{\oCtxt}{\ensuremath{\code{o}}}
% \newcommand{\N}{\ensuremath{N}}
% \newcommand{\M}{\ensuremath{M}}
% \newcommand{\heap}{\ensuremath{\mathcal{H}}}
% \newcommand{\val}{\ensuremath{v}}
% \newcommand{\dyninside}[2]{\ensuremath{\heap \vdash #1 \preceq #2}}
% \newcommand{\dyninsideE}[3]{\ensuremath{#1 \vdash #2 \preceq #3}}
% \newcommand{\notdyninsideE}[3]{\ensuremath{#1 \vdash #2 \npreceq #3}}
% \newcommand{\dynfalseinsideE}[3]{\ensuremath{#1 \nvdash #2 \preceq #3}}
% \newcommand{\dyninsidesub}[4]{\ensuremath{#1 \vdash #2 (#3 \preceq #4)}}
\newcommand{\dyninsidesubmany}[3]{\ensuremath{\heap \vdash #1 (\overline{#2 \preceq #3})}}
\newcommand{\dyninsidesubmanyC}[3]{\ensuremath{#1 \vdash \overline{#2 \preceq #3}}}
\newcommand{\dyninsidesubmanyE}[5]{\ensuremath{#1 \vdash #2( #3 (\overline{#4 \preceq #5}))}}
\newcommand{\dyninsidesubmanyA}[4]{\ensuremath{#1 \vdash #2 (\overline{#3 \preceq #4})}}
\newcommand{\dyninsidesubmanyB}[3]{\ensuremath{#1 \vdash \overline{#2 \preceq #3}}}
% \newcommand{\wellFormedE}[2]{\ensuremath{#1 \vdash #2 \oks}}
\newcommand{\oks}{\mbox{ \sc ok}}
% \newcommand{\redArrow}{\leadsto}
% \newcommand{\lilspace} {\hspace{2pt}}
% \newcommand{\gammaProvesE}[3]{\ensuremath{#1 \vdash #2 : #3}}
% \newcommand{\gammaProvesManyA}[3]{\ensuremath{#1 \vdash \many{#2\lilspace :\lilspace #3}}}
% \newcommand{\subTypeE}[3]{\ensuremath{#1\vdash #2 <: #3}}

\ProvidesFile{omscmtt.fd}
\DeclareFontFamily{OMS}{cmtt}{\skewchar\font48 }
\DeclareFontShape{OMS}{cmtt}{m}{n}%
   {<->ssub*cmsy/m/n}{}
\DeclareFontShape{OMS}{cmtt}{m}{it}%
   {<->ssub*cmsy/m/n}{}
\DeclareFontShape{OMS}{cmtt}{m}{sl}%
   {<->ssub*cmsy/m/n}{}
\DeclareFontShape{OMS}{cmtt}{m}{sc}%
   {<->ssub*cmsy/m/n}{}
\DeclareFontShape{OMS}{cmtt}{bx}{n}%
   {<->ssub*cmsy/b/n}{}
\DeclareFontShape{OMS}{cmtt}{bx}{it}%
   {<->ssub*cmsy/b/n}{}
\DeclareFontShape{OMS}{cmtt}{bx}{sl}%
   {<->ssub*cmsy/b/n}{}
\DeclareFontShape{OMS}{cmtt}{bx}{sc}%
   {<->ssub*cmsy/b/n}{}
\endinput
% %%
%% End of file `omscmtt.fd'.
